<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Recorte de Crachá em PDF</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f8f9fa;
      color: #333;
      min-height: 100vh;
      margin: 0;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .container {
      background: #fff;
      padding: 2em 2.5em;
      border-radius: 8px;
      box-shadow: 0 4px 24px rgba(0,0,0,0.07);
      min-width: 320px;
      max-width: 420px;
      text-align: center;
    }
    .badges {
      display: flex;
      flex-wrap: wrap;
      gap: 1em;
      justify-content: center;
      margin-top: 1.5em;
    }
    .badges img {
      border: 1px solid #ddd;
      border-radius: 8px;
      background: #fafafa;
      width: 64px;
      height: 64px;
      object-fit: cover;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Recorte do Crachá do PDF</h1>
    <p>Selecione arquivos PDF. O crachá da página será exibido abaixo.</p>
    <input type="file" id="fileUpload" accept=".pdf,application/pdf" multiple>
    <div class="badges" id="badges"></div>
  </div>
  <!-- PDF.js CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.2.67/pdf.min.js"></script>
  <script>
    const input = document.getElementById('fileUpload');
    const badges = document.getElementById('badges');

    input.addEventListener('change', async function () {
      badges.innerHTML = '';
      for (const file of input.files) {
        const reader = new FileReader();
        reader.onload = async function (e) {
          const typedarray = new Uint8Array(e.target.result);
          const pdf = await pdfjsLib.getDocument(typedarray).promise;
          const page = await pdf.getPage(1);

          // Renderiza página em um canvas
          const viewport = page.getViewport({ scale: 2 }); // Aumenta resolução
          const canvas = document.createElement('canvas');
          const context = canvas.getContext('2d');
          canvas.width = viewport.width;
          canvas.height = viewport.height;

          await page.render({ canvasContext: context, viewport }).promise;

          // Recorta a área do crachá (ajuste x, y, w, h conforme necessário)
          // Exemplo: recorte de 0,0 até 64x64 pixels no canto superior esquerdo
          const badgeCanvas = document.createElement('canvas');
          const badgeSize = 64; // pixels
          badgeCanvas.width = badgeSize;
          badgeCanvas.height = badgeSize;
          const badgeCtx = badgeCanvas.getContext('2d');
          badgeCtx.drawImage(canvas, 0, 0, badgeSize, badgeSize, 0, 0, badgeSize, badgeSize);

          // Exibe imagem recortada
          const img = document.createElement('img');
          img.src = badgeCanvas.toDataURL();
          badges.appendChild(img);
        };
        reader.readAsArrayBuffer(file);
      }
    });
  </script>
</body>
</html>